<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Firefly Run â€” Nature Ballet</title>
<link rel="icon" href="favicon.svg" type="image/svg+xml">
<link rel="stylesheet" href="style.css?v=nb2">
<style>
/* Ensure interactive layers are above background and canvas */
.nav, .nav * , .cta, .cta * , #panel, .brand { position: relative; z-index: 9999; pointer-events: auto; }
#bg { pointer-events: none !important; z-index: 0 !important; }
.canvasWrap { position: relative; z-index: 1; }
.canvasWrap canvas { pointer-events: none; }
html, body { overscroll-behavior: none; }
</style>
</head>
<body>
<header class="nav">
  <div class="brand"><span class="logo">ğŸª„</span><span>Firefly Run</span></div>
  <nav>
    <button id="btn-play" class="btn">Play</button>
    <button id="btn-levels" class="btn ghost">Levels</button>
    <button id="btn-stats" class="btn ghost">Stats</button>
    <button id="btn-options" class="btn ghost">Options</button>
  </nav>
</header>

<main id="hero">
  <h1>Firefly Run â€” <span>Nature Ballet</span></h1>
  <p class="tag">A precision dodger inspired by â€œThe Worldâ€™s Hardest Game.â€ Collect the fireflies, reach the glade, and donâ€™t touch red.</p>
  <div class="cta">
    <button id="cta-play" class="btn xl">â–¶ Play Now</button>
    <button id="cta-how" class="btn ghost">How to Play</button>
  </div>
  <ul class="quick">
    <li>WASD / Arrows to move</li>
    <li>R to restart â€¢ Esc for menu</li>
  </ul>
  <canvas id="bg" width="1200" height="420" aria-hidden="true"></canvas>
</main>

<section id="panel" class="panel hidden" aria-live="polite"></section>
<div class="canvasWrap"><canvas id="game" width="960" height="520"></canvas></div>

<footer class="foot">Â© 2025 Firefly Run â€¢ Nature Ballet</footer>

<script>
// Hard-reset old SW/caches so redesign loads clean
document.addEventListener('DOMContentLoaded', async () => {
  try {
    if ('serviceWorker' in navigator) {
      const regs = await navigator.serviceWorker.getRegistrations();
      await Promise.all(regs.map(r => r.unregister()));
    }
    if (window.caches) {
      const keys = await caches.keys();
      await Promise.all(keys.map(k => caches.delete(k)));
    }
  } catch (e) {}
  const $ = s => document.querySelector(s);
  const on = (sel, ev, fn) => { const el = typeof sel === 'string' ? $(sel) : sel; el && el.addEventListener(ev, (e)=>{ e.preventDefault(); fn(e); }); };
  const bootSafe = () => { if (window.__fireflyBoot) { window.__fireflyBoot(0); } else { alert('Game not loaded yet.'); } };
  on('#btn-play','click', bootSafe);
  on('#cta-play','click', bootSafe);
  on('#btn-levels','click', ()=> window.__fireflyShowLevels && window.__fireflyShowLevels());
  on('#btn-stats','click', ()=> window.__fireflyShowStats && window.__fireflyShowStats());
  on('#btn-options','click', ()=> window.__fireflyShowOptions && window.__fireflyShowOptions());
  on('#cta-how','click', ()=> window.__fireflyShowHow && window.__fireflyShowHow());
});
</script>
<script src="game.js?v=nb2" defer></script>
</body>
</html>
